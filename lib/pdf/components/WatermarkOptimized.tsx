/**
 * Оптимизированный компонент водяного знака для PDF документов
 * Версия с меньшим количеством повторений для лучшей производительности
 */

import { View, Svg, Path, StyleSheet } from '@react-pdf/renderer';

const styles = StyleSheet.create({
  watermarkContainer: {
    position: 'absolute',
    top: 0,
    left: 0,
    right: 0,
    bottom: 0,
    zIndex: -1,
  },
});

/**
 * Полный текст "edubaza.uz" как один SVG компонент
 */
const EduBazaLogo = () => (
  <Svg width="130" height="60" viewBox="0 0 130 60">
    {/* e */}
    <Path d="M10.1851 37.6725C12.8632 36.9549 15.2319 37.3535 17.2911 38.8684C19.0701 40.1622 20.253 42.0293 20.8399 44.4697C20.9986 45.1298 20.5724 45.7736 19.9166 45.9493L9.91456 48.6294C9.70448 48.6857 9.60377 48.926 9.73456 49.0998C10.0659 49.54 10.5011 49.8797 11.0402 50.1189C11.7178 50.4195 12.5072 50.495 13.4086 50.3454C14.0414 50.2217 14.6183 49.9753 15.1394 49.606C15.4102 49.4008 15.6303 49.1837 15.7996 48.9548C16.0713 48.5878 16.4019 48.2344 16.8429 48.1163L19.6183 47.3726C20.4681 47.1449 21.3074 47.7975 21.1098 48.6547C20.8349 49.8474 20.2752 50.9179 19.4305 51.8662C18.2163 53.2479 16.6237 54.2028 14.6526 54.7309C12.0388 55.4313 9.7746 55.1654 7.86001 53.9332C5.9611 52.6739 4.69016 50.8444 4.0472 48.4449C3.39276 46.0025 3.63226 43.7683 4.76571 41.7424C5.91484 39.6893 7.72132 38.3327 10.1851 37.6725ZM11.3241 42.0517C10.5314 42.2641 9.88677 42.6435 9.39022 43.1899C9.01935 43.5903 8.77263 44.0463 8.65005 44.5578C8.59615 44.7826 8.81048 44.9641 9.03386 44.9043L14.7138 43.3824C14.9337 43.3234 15.0306 43.065 14.8819 42.8925C14.0443 41.9209 12.8584 41.6406 11.3241 42.0517Z" fill="#1761FF" fillOpacity="0.1"/>
    {/* d */}
    <Path d="M32.5689 34.2926C32.6156 34.28 32.6434 34.232 32.6309 34.1852L31.2284 28.9512C30.6791 26.9012 31.8957 24.7941 33.9457 24.2448C34.629 24.0617 35.3314 24.4672 35.5145 25.1506L41.1114 46.0388C41.2707 46.633 41.0019 47.2589 40.4613 47.5526L39.1266 48.2778C38.6099 48.5585 37.9702 48.4668 37.5531 48.0523L35.9582 46.467C35.9274 46.4364 35.8828 46.4245 35.8409 46.4358C35.8027 46.446 35.7719 46.4742 35.7579 46.5111C35.4368 47.3535 34.9165 48.1067 34.1968 48.7707C33.4604 49.4503 32.5566 49.9336 31.4853 50.2206C29.3 50.8061 27.2958 50.4821 25.4726 49.2484C23.6652 47.9875 22.4285 46.1144 21.7625 43.6292C21.0909 41.1225 21.2418 38.9006 22.2153 36.9634C23.2103 35.0206 24.779 33.7621 26.9215 33.188C27.9927 32.901 29.0171 32.8676 29.9946 33.0879C30.9561 33.3046 31.7879 33.7004 32.49 34.2754C32.512 34.2934 32.5414 34.2999 32.5689 34.2926ZM27.1538 39.3257C26.6363 40.2222 26.5268 41.2274 26.8253 42.3415C27.1238 43.4556 27.7241 44.2821 28.6263 44.8211C29.5228 45.3387 30.5066 45.454 31.5779 45.1669C32.6491 44.8799 33.4406 44.2774 33.9525 43.3596C34.4643 42.4417 34.5738 41.4364 34.281 40.3437C33.994 39.2725 33.3994 38.4674 32.4972 37.9284C31.6107 37.3623 30.6211 37.2256 29.5284 37.5183C28.4572 37.8054 27.6657 38.4078 27.1538 39.3257Z" fill="#1761FF" fillOpacity="0.1"/>
    {/* u */}
    <Path d="M41.0799 39.0387L39.8076 34.2904C39.2547 32.2271 40.4792 30.1063 42.5425 29.5535C43.2302 29.3692 43.9372 29.7773 44.1215 30.4651L46.0439 37.6397C46.2907 38.5609 46.7574 39.274 47.4438 39.779C48.1244 40.2625 48.9576 40.3723 49.9431 40.1082C50.9286 39.8441 51.5952 39.3326 51.943 38.5735C52.2849 37.7929 52.3325 36.9421 52.0856 36.0208L50.8306 31.3368C50.2777 29.2735 51.5022 27.1527 53.5655 26.5999C54.2532 26.4156 54.9601 26.8237 55.1444 27.5115L57.0841 34.7504C57.75 37.2356 57.5576 39.3883 56.5067 41.2084C55.4773 43.0227 53.72 44.2628 51.2347 44.9287C48.7709 45.5889 46.629 45.3936 44.8089 44.3428C42.9888 43.292 41.7458 41.5239 41.0799 39.0387Z" fill="#1761FF" fillOpacity="0.1"/>
    {/* b */}
    <Path d="M66.2644 22.6461C68.4068 22.072 70.3839 22.3804 72.1956 23.5713C74.0287 24.7564 75.2811 26.6023 75.9527 29.109C76.6186 31.5942 76.4735 33.8376 75.5171 35.839C74.5765 37.8132 73.0136 39.0931 70.8282 39.6787C69.757 39.9657 68.7326 39.9991 67.7551 39.7788C66.7998 39.5635 65.9726 39.1714 65.2734 38.6025C65.2427 38.5775 65.202 38.5685 65.1638 38.5787C65.1219 38.5899 65.0892 38.6226 65.0778 38.6644L64.4892 40.8348C64.3353 41.4023 63.8271 41.8016 63.2393 41.8168L61.7208 41.8561C61.1058 41.8721 60.5601 41.4644 60.4009 40.8702L54.8039 19.982C54.6208 19.2986 55.0263 18.5963 55.7096 18.4132C57.7596 17.8639 59.8668 19.0804 60.4161 21.1304L61.8185 26.3644C61.831 26.4112 61.8791 26.4389 61.9259 26.4264C61.9534 26.419 61.9755 26.3987 61.9856 26.3721C62.3061 25.5231 62.8285 24.7644 63.5529 24.096C64.2893 23.4164 65.1931 22.9331 66.2644 22.6461ZM65.2611 34.9704C66.1633 35.5094 67.15 35.6354 68.2213 35.3484C69.2925 35.0613 70.0869 34.4696 70.6045 33.5731C71.1163 32.6552 71.223 31.6393 70.9244 30.5252C70.6259 29.4111 70.0284 28.5953 69.132 28.0777C68.2298 27.5387 67.2431 27.4127 66.1718 27.6998C65.0792 27.9925 64.2798 28.6086 63.7737 29.5479C63.2833 30.46 63.1816 31.4517 63.4687 32.5229C63.7615 33.6156 64.3589 34.4314 65.2611 34.9704Z" fill="#1761FF" fillOpacity="0.1"/>
    {/* a */}
    <Path d="M87.8539 19.479C87.8958 19.4677 87.9286 19.4351 87.9399 19.3933L88.0993 18.8054C88.5079 17.2987 89.857 16.2388 91.4176 16.1984C91.9618 16.1843 92.4447 16.545 92.5856 17.0709L96.3795 31.2298C96.5387 31.824 96.2699 32.4499 95.7293 32.7436L94.3947 33.4687C93.8779 33.7495 93.2382 33.6578 92.8211 33.2433L91.2262 31.658C91.1955 31.6274 91.1508 31.6155 91.1089 31.6267C91.0707 31.637 91.04 31.6652 91.0259 31.7021C90.7048 32.5444 90.1845 33.2976 89.4648 33.9617C88.7284 34.6412 87.8246 35.1245 86.7534 35.4116C84.6109 35.9856 82.6231 35.6801 80.79 34.495C78.9783 33.3042 77.7367 31.4554 77.065 28.9487C76.3991 26.4634 76.5364 24.2337 77.4771 22.2594C78.4334 20.258 80.0042 18.9645 82.1895 18.379C83.2607 18.092 84.2851 18.0586 85.2626 18.2789C86.2179 18.4941 87.0451 18.8862 87.7443 19.4552C87.775 19.4802 87.8157 19.4892 87.8539 19.479ZM86.8459 30.3579C87.9385 30.0651 88.7301 29.4627 89.2205 28.5505C89.7266 27.6112 89.8361 26.606 89.5491 25.5347C89.2563 24.4421 88.6588 23.6262 87.7566 23.0873C86.8544 22.5483 85.8677 22.4223 84.7965 22.7093C83.7252 22.9964 82.9337 23.5988 82.4219 24.5167C81.9043 25.4131 81.7948 26.4184 82.0933 27.5325C82.3918 28.6466 82.9922 29.4731 83.8944 30.0121C84.7908 30.5297 85.7747 30.6449 86.8459 30.3579Z" fill="#1761FF" fillOpacity="0.1"/>
    {/* z */}
    <Path d="M109.138 15.5814C109.234 15.9399 109.176 16.3222 108.978 16.636L103.988 24.5443C103.826 24.8004 104.063 25.1216 104.355 25.0432L107.889 24.0965C109.886 23.5614 111.938 24.7464 112.473 26.7431C112.651 27.4087 112.256 28.0928 111.591 28.2712L99.2983 31.5649C98.5884 31.7551 97.8586 31.3338 97.6684 30.6239L97.0441 28.2938C96.948 27.9354 97.006 27.5531 97.204 27.2392L102.194 19.3309C102.356 19.0749 102.119 18.7536 101.826 18.832L98.9358 19.6066C96.939 20.1416 94.8866 18.9566 94.3516 16.9599C94.1733 16.2943 94.5682 15.6102 95.2338 15.4319L106.883 12.3103C107.593 12.1201 108.323 12.5414 108.513 13.2514L109.138 15.5814Z" fill="#1761FF" fillOpacity="0.1"/>
    {/* a (второе) */}
    <Path d="M121.839 10.404C121.881 10.3928 121.914 10.3602 121.925 10.3183L122.514 8.14796C122.668 7.58039 123.176 7.18114 123.764 7.16591L125.282 7.12659C125.897 7.11067 126.443 7.51832 126.602 8.11253L130.365 22.1548C130.524 22.749 130.255 23.3749 129.715 23.6686L128.38 24.3938C127.863 24.6746 127.224 24.5829 126.807 24.1683L125.212 22.583C125.181 22.5525 125.136 22.5406 125.094 22.5518C125.056 22.562 125.025 22.5902 125.011 22.6272C124.69 23.4695 124.17 24.2227 123.45 24.8867C122.714 25.5663 121.81 26.0496 120.739 26.3366C118.596 26.9107 116.609 26.6052 114.775 25.4201C112.964 24.2292 111.722 22.3804 111.05 19.8738C110.385 17.3885 110.522 15.1587 111.462 13.1845C112.419 11.1831 113.99 9.88959 116.175 9.30404C117.246 9.017 118.271 8.98363 119.248 9.20392C120.203 9.41919 121.031 9.8113 121.73 10.3803C121.76 10.4052 121.801 10.4143 121.839 10.404ZM120.831 21.283C121.924 20.9902 122.716 20.3877 123.206 19.4756C123.712 18.5363 123.822 17.531 123.534 16.4598C123.242 15.3671 122.644 14.5513 121.742 14.0123C120.84 13.4733 119.853 13.3473 118.782 13.6344C117.711 13.9214 116.919 14.5239 116.407 15.4417C115.89 16.3382 115.78 17.3435 116.079 18.4575C116.377 19.5716 116.978 20.3982 117.88 20.9372C118.776 21.4547 119.76 21.57 120.831 21.283Z" fill="#1761FF" fillOpacity="0.1"/>
  </Svg>
);

interface WatermarkOptimizedProps {
  opacity?: number;
  /** Режим отображения: 'grid' - сетка, 'diagonal' - диагональ, 'center' - центр */
  mode?: 'grid' | 'diagonal' | 'center';
}

export const WatermarkOptimized = ({
  opacity = 0.03,
  mode = 'diagonal'
}: WatermarkOptimizedProps) => {

  if (mode === 'center') {
    // Один большой водяной знак в центре
    return (
      <View style={[styles.watermarkContainer, { opacity }]} fixed>
        <View style={{
          position: 'absolute',
          top: '40%',
          left: '30%',
          transform: 'rotate(-45deg)',
        }}>
          <Svg width="300" height="150" viewBox="0 0 130 60" preserveAspectRatio="xMidYMid meet">
            <EduBazaLogo />
          </Svg>
        </View>
      </View>
    );
  }

  if (mode === 'diagonal') {
    // Диагональный паттерн (без дополнительного наклона, так как SVG уже наклонен)
    return (
      <View style={[styles.watermarkContainer, { opacity }]} fixed>
        {[0, 1, 2, 3, 4, 5, 6, 7, 8].map((i) => (
          <View
            key={i}
            style={{
              position: 'absolute',
              left: (i % 3) * 250 - 100,
              top: Math.floor(i / 3) * 300 - 50,
            }}
          >
            <EduBazaLogo />
          </View>
        ))}
      </View>
    );
  }

  // Сетка (mode === 'grid')
  return (
    <View style={[styles.watermarkContainer, { opacity }]} fixed>
      {[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11].map((i) => (
        <View
          key={i}
          style={{
            position: 'absolute',
            left: (i % 4) * 150 + 20,
            top: Math.floor(i / 4) * 280 + 50,
          }}
        >
          <EduBazaLogo />
        </View>
      ))}
    </View>
  );
};

export default WatermarkOptimized;
